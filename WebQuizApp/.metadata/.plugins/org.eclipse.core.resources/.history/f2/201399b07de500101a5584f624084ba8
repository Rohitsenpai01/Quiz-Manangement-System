<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>

<!DOCTYPE html>
<html>
<head><title>Processing Quiz</title></head>
<body>
    <jsp:useBean id="quizBean" class="com.app.beans.CreateQuizBean" scope="page" />
    
    <%
        // Manual mapping because Part cannot be set via <jsp:setProperty> easily
        quizBean.setTitle(request.getParameter("title"));
        quizBean.setUserId(Integer.parseInt(request.getParameter("user_id")));
        quizBean.setFilePart(request.getPart("filename"));
        
        // Execute logic
        quizBean.processQuiz(application.getRealPath("/"));
    %>

    <c:choose>
        <c:when test="${quizBean.success}">
            <h3 style="color:green;">Success!</h3>
            <p>${quizBean.message}</p>
        </c:when>
        <c:otherwise>
            <h3 style="color:red;">Failed</h3>
            <p>${quizBean.message}</p>
        </c:otherwise>
    </c:choose>

    <br>
    <a href="quizlist.jsp">View All Quizzes</a>
</body>
</html>