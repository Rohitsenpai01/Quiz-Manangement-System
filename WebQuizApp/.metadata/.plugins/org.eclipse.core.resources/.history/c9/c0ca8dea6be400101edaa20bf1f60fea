package com.app.daos;

import java.sql.PreparedStatement;

public class QuizDaoImp extends Dao implements QuizDao{
	private PreparedStatement stmtFindAll;
	private PreparedStatement stmtFindById;
	private PreparedStatement stmtSave;
	private PreparedStatement stmtUpdate;
	private PreparedStatement stmtDeleteById;
	
	public QuizDaoImp() throws Exception {
		String sqlFindAll = "SELECT quiz_id, title, creator_id FROM quizzes";
		stmtFindAll = con.prepareStatement(sqlFindAll);
		String sqlFindById = "SELECT * FROM quizzes";
		stmtFindById = con.prepareStatement(sqlFindById);
		String sqlSave = "INSERT INTO quizzes (title, creator_id) VALUES (?, ?)";
		stmtSave = con.prepareStatement(sqlSave);
		String sqlDeleteById = "DELETE FROM quizzes WHERE quiz_id = ?";
		stmtDeleteById = con.prepareStatement(sqlDeleteById);
		String sqlUpdate = "UPDATE quizzes SET name = ? WHERE quiz_id = ?";
		stmtUpdate = con.prepareStatement(sqlUpdate);
	}
	
	public void close() throws Exception {
		stmtFindAll.close();
		stmtFindById.close();
		stmtSave.close();
		stmtDeleteById.close();
		stmtUpdate.close();
	}
}
